---
/**
 * UseCasesCarousel.astro - JAV√çTOTT VERZI√ì
 * Egyszer≈±bb, megb√≠zhat√≥bb carousel
 */

import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import Headline from '~/components/ui/Headline.astro';

const {
  id,
  isDark = false,
  classes = {},
} = Astro.props;

const useCases = [
  {
    id: 'faultetes',
    title: 'Fa√ºltet√©s',
    subtitle: 'Tart√≥ C√∂l√∂p√∂k',
    description: 'Fiatal f√°k v√©delme √©s t√°maszt√°sa. A tel√≠tett c√∂l√∂p√∂k ak√°r 25 √©vig tartanak talajkontaktusban.',
    features: ['UC4 min≈ës√≠t√©s', 'Hegyezett v√©g', '15-25 √©v'],
    href: '/felhasznalasok/faultetes',
    image: 'https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?w=800&h=500&fit=crop',
    icon: 'üå≥',
    gradient: 'from-emerald-600 to-green-700',
  },
  {
    id: 'jatszoter',
    title: 'Gyermekj√°tsz√≥t√©r',
    subtitle: 'Biztons√°gos & Tart√≥s',
    description: 'EN 71-3 szabv√°nynak megfelel≈ë, neh√©zf√©m-mentes fa. K√∂zt√©ri √©s kerti j√°tsz√≥terekhez.',
    features: ['Gyermekbar√°t', 'Neh√©zf√©m-mentes', 'EN 71-3'],
    href: '/felhasznalasok/jatszoter',
    image: 'https://images.unsplash.com/photo-1587616211892-d7a3c0f5f5e8?w=800&h=500&fit=crop',
    icon: 'üé†',
    gradient: 'from-purple-600 to-pink-600',
  },
  {
    id: 'kertepites',
    title: 'Kert√©p√≠t√©s',
    subtitle: 'Pergol√°k & T√°mfalak',
    description: 'Pergol√°k, lugasok, t√°mfalak, vir√°gl√°d√°k. Tart√≥s kerti √©p√≠tm√©nyek alapanyaga.',
    features: ['Festhet≈ë', 'Id≈ëj√°r√°s√°ll√≥', 'Term√©szetes'],
    href: '/felhasznalasok/kertepites',
    image: 'https://images.unsplash.com/photo-1600585152220-90363fe7e115?w=800&h=500&fit=crop',
    icon: 'üè°',
    gradient: 'from-teal-600 to-cyan-600',
  },
  {
    id: 'keritesek',
    title: 'Ker√≠t√©s√©p√≠t√©s',
    subtitle: 'R√∫dfa & Oszlopok',
    description: 'Ker√≠t√©soszlopok, kapuoszlopok, l√©cek. A r√∫dfa a legkedveltebb ker√≠t√©s alapanyag.',
    features: ['R√∫dfa v√°laszt√©k', 'F√∂ldbe verhet≈ë', '√âvtizedekig tart'],
    href: '/felhasznalasok/keritesek',
    image: 'https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?w=800&h=500&fit=crop',
    icon: 'üèóÔ∏è',
    gradient: 'from-slate-600 to-gray-700',
  },
  {
    id: 'kerti-epitmenyek',
    title: 'Kerti √âp√≠tm√©nyek',
    subtitle: 'H√°zik√≥k & T√°rol√≥k',
    description: 'Kerti h√°zak, szersz√°mt√°rol√≥k, kutyah√°zak. B√°rmit meg√©p√≠thet tel√≠tett f√°b√≥l!',
    features: ['K√∂nnyen munk√°lhat√≥', 'Stabil', 'DIY bar√°t'],
    href: '/felhasznalasok/kerti-epitmenyek',
    image: 'https://images.unsplash.com/photo-1600566753086-00f18fb6b3ea?w=800&h=500&fit=crop',
    icon: 'üõñ',
    gradient: 'from-amber-600 to-orange-600',
  },
  {
    id: 'kozterulet',
    title: 'K√∂zter√ºletek',
    subtitle: 'Parkok & S√©t√°nyok',
    description: '√ñnkorm√°nyzati projektek, parkos√≠t√°s, padok, √∫tjelz≈ëk professzion√°lis kivitelben.',
    features: ['Vand√°lbiztos', 'Alacsony karbantart√°s', 'Professzion√°lis'],
    href: '/felhasznalasok/kozterulet',
    image: 'https://images.unsplash.com/photo-1573204464719-6bbfb61da1ea?w=800&h=500&fit=crop',
    icon: 'üèõÔ∏è',
    gradient: 'from-blue-600 to-indigo-600',
  },
];
---

<WidgetWrapper id={id} isDark={isDark} containerClass={`max-w-6xl mx-auto ${classes?.container ?? ''}`}>
  <Headline
    title="Mire Haszn√°lhat√≥ a Tel√≠tett Borovifa?"
    subtitle="Fa√ºltet√©st≈ël j√°tsz√≥terig ‚Äì biztons√°gos, tart√≥s megold√°sok minden k√ºlt√©ri alkalmaz√°shoz"
    tagline="ü™µ Felhaszn√°l√°si Ter√ºletek"
  />

  <div class="mt-10" id="carousel-container">
    
    <!-- F≈ë k√°rtya -->
    <div class="relative">
      <div class="carousel-viewport overflow-hidden rounded-2xl shadow-2xl">
        <div class="carousel-track flex transition-transform duration-700 ease-out">
          {useCases.map((item, index) => (
            <div class="carousel-slide w-full flex-shrink-0" data-index={index}>
              <a href={item.href} class="block relative group">
                <div class="relative aspect-[16/9] md:aspect-[2/1] overflow-hidden">
                  <img 
                    src={item.image} 
                    alt={item.title}
                    class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                  />
                  <div class={`absolute inset-0 bg-gradient-to-r ${item.gradient} opacity-70`}></div>
                  <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent"></div>
                </div>
                <div class="absolute inset-0 flex flex-col justify-end p-6 md:p-10">
                  <div class="absolute top-6 right-6 md:top-8 md:right-8">
                    <div class="w-16 h-16 md:w-20 md:h-20 bg-white/90 backdrop-blur rounded-2xl flex items-center justify-center text-4xl md:text-5xl shadow-lg transition-transform duration-300 group-hover:scale-110 group-hover:rotate-6">
                      {item.icon}
                    </div>
                  </div>
                  <div class="max-w-2xl">
                    <span class="inline-block px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-white text-sm font-medium mb-3">
                      {item.subtitle}
                    </span>
                    <h3 class="text-3xl md:text-4xl font-bold text-white mb-3">{item.title}</h3>
                    <p class="text-white/90 text-lg mb-4 hidden md:block">{item.description}</p>
                    <div class="flex flex-wrap gap-2 mb-4">
                      {item.features.map((f) => (
                        <span class="inline-flex items-center gap-1 px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-white text-sm">
                          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
                          {f}
                        </span>
                      ))}
                    </div>
                    <span class="inline-flex items-center gap-2 px-5 py-2.5 bg-white text-gray-900 rounded-xl font-semibold transition-all group-hover:gap-3">
                      R√©szletek
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                    </span>
                  </div>
                </div>
              </a>
            </div>
          ))}
        </div>
      </div>

      <!-- Nyilak -->
      <button type="button" class="carousel-prev absolute left-3 top-1/2 -translate-y-1/2 z-10 w-12 h-12 bg-white/90 hover:bg-white rounded-full shadow-lg flex items-center justify-center transition-all hover:scale-110">
        <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
      </button>
      <button type="button" class="carousel-next absolute right-3 top-1/2 -translate-y-1/2 z-10 w-12 h-12 bg-white/90 hover:bg-white rounded-full shadow-lg flex items-center justify-center transition-all hover:scale-110">
        <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
      </button>

      <!-- Progress -->
      <div class="absolute bottom-0 left-0 right-0 h-1 bg-black/20">
        <div class="carousel-progress h-full bg-white transition-all duration-100" style="width: 0%"></div>
      </div>

              <div class="absolute bottom-0 left-0 right-0 h-1 bg-white/30 z-20">
          <div class="featured-progress h-full bg-white transition-all duration-100" style="width: 0%"></div>
        </div>
    </div>

    <!-- Dots -->
    <div class="flex justify-center gap-2 mt-6">
      {useCases.map((item, index) => (
        <button type="button" class={`carousel-dot w-3 h-3 rounded-full transition-all duration-300 ${index === 0 ? 'w-8 bg-gradient-to-r ' + item.gradient : 'bg-gray-300 dark:bg-slate-600'}`} data-index={index}></button>
      ))}
    </div>

    <!-- Quick nav -->
    <div class="grid grid-cols-3 md:grid-cols-6 gap-2 mt-6">
      {useCases.map((item, index) => (
        <button type="button" class={`carousel-quick p-3 rounded-xl border-2 transition-all text-center ${index === 0 ? 'border-transparent bg-gradient-to-r ' + item.gradient + ' text-white shadow-md' : 'border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800'}`} data-index={index}>
          <span class="text-xl block">{item.icon}</span>
          <span class="text-xs font-medium block mt-1 truncate">{item.title}</span>
        </button>
      ))}
    </div>
  </div>
</WidgetWrapper>

<script is:inline>
document.addEventListener('DOMContentLoaded', function() {
  var container = document.getElementById('carousel-container');
  if (!container) return;

  var track = container.querySelector('.carousel-track');
  var dots = container.querySelectorAll('.carousel-dot');
  var quickBtns = container.querySelectorAll('.carousel-quick');
  var prevBtn = container.querySelector('.carousel-prev');
  var nextBtn = container.querySelector('.carousel-next');
  var progressBar = container.querySelector('.carousel-progress');

  var gradients = [
    'from-emerald-600 to-green-700',
    'from-purple-600 to-pink-600',
    'from-teal-600 to-cyan-600',
    'from-slate-600 to-gray-700',
    'from-amber-600 to-orange-600',
    'from-blue-600 to-indigo-600'
  ];

  var current = 0;
  var total = 6;
  var progress = 0;
  var timer = null;

  function goTo(index) {
    if (index < 0) index = total - 1;
    if (index >= total) index = 0;
    current = index;
    track.style.transform = 'translateX(-' + (current * 100) + '%)';
    
    dots.forEach(function(dot, i) {
      dot.className = 'carousel-dot w-3 h-3 rounded-full transition-all duration-300';
      if (i === current) {
        dot.classList.add('w-8', 'bg-gradient-to-r');
        gradients[i].split(' ').forEach(function(c) { dot.classList.add(c); });
      } else {
        dot.classList.add('bg-gray-300', 'dark:bg-slate-600');
      }
    });

    quickBtns.forEach(function(btn, i) {
      btn.className = 'carousel-quick p-3 rounded-xl border-2 transition-all text-center';
      if (i === current) {
        btn.classList.add('border-transparent', 'bg-gradient-to-r', 'text-white', 'shadow-md');
        gradients[i].split(' ').forEach(function(c) { btn.classList.add(c); });
      } else {
        btn.classList.add('border-gray-200', 'dark:border-slate-700', 'bg-white', 'dark:bg-slate-800');
      }
    });

    progress = 0;
    if (progressBar) progressBar.style.width = '0%';
  }

  function startTimer() {
    stopTimer();
    timer = setInterval(function() {
      progress += 2;
      if (progressBar) progressBar.style.width = progress + '%';
      if (progress >= 100) {
        goTo(current + 1);
      }
    }, 100);
  }

  function stopTimer() {
    if (timer) { clearInterval(timer); timer = null; }
  }

  prevBtn.addEventListener('click', function() { goTo(current - 1); });
  nextBtn.addEventListener('click', function() { goTo(current + 1); });

  dots.forEach(function(dot) {
    dot.addEventListener('click', function() {
      goTo(parseInt(this.dataset.index));
    });
  });

  quickBtns.forEach(function(btn) {
    btn.addEventListener('click', function() {
      goTo(parseInt(this.dataset.index));
    });
  });

  container.addEventListener('mouseenter', stopTimer);
  container.addEventListener('mouseleave', startTimer);

  startTimer();
});
</script>